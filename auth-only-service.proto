syntax = "proto3";
import "public-service.proto";
service AuthOnlyService {
    rpc SignUp(AccountInfo) returns (Empty) {} // Called only if the account does not exist
    rpc VerifyMail(VerifyMailRequest) returns (VerifyMailResponse) {}

    rpc GetAccountInfo(Empty) returns (AccountInfo) {}
    rpc GetProfilePic(Empty) returns (ProfilePic) {}
    rpc DeleteAccount(Empty) returns (Empty) {}
    rpc SetProfilePic(ProfilePic) returns (Empty) {}
    // If the mail is changed, is needed to verify the account (and the eventual old verification code becomed invalid), you can call this function even if
    // the account is not verified, because for example the mail was wrong.
    rpc UpdateAccountInfo(AccountInfo) returns (Empty) {}

    // FOR EVERY FOLLOWING RPC IS ASSUMED THAT THE CALLER HAS A VERIFIED ACCOUNT
}


message VerifyMailRequest {
    string verificationCode = 1; // Not empty
}
message VerifyMailResponse {
    bool ok = 1;
}

message AccountInfo {
    string name = 1; // Not empty
    string surname = 2; // Not empty
    string mail = 3; // Is a valid mail format
    string telegramUsername = 4; // Valid
}
message ProfilePic {
    optional bytes image = 1; // Valid AVIF image, max lenght = 512kb
}