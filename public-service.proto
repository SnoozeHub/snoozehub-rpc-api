syntax = "proto3";
import "common-messages.proto";

service PublicService {
	// Authentication
	rpc GetNonce (Empty) returns (GetNonceResponse);
	rpc Auth (AuthRequest) returns (AuthResponse);


	rpc GetBeds(GetBedsRequest) returns (BedList); // Every bed returned has the field bedMutableInfo mondadory
	rpc GetReview(GetReviewsRequest) returns (GetReviewsResponse);
}

message GetNonceResponse {
	string nonce = 1; // Not empty
}

message AuthRequest {
	string address = 1; // Valid format
	string nonceSigned = 2; // Valid format
}

message AuthResponse {
	string authToken = 1; // Not empty
	bool accountDoesNotExist = 2;
}

message GetBedsRequest {
	uint32 date = 1; // 8 digit (base 10) number, for example 30012000 -> 30-01-2000
	string place = 2; // length=1-100

	Features featuresMondadory = 3;

	// Get first N results in order by proximity from fromIndex to fromIndex+N where N=15.
	uint32 fromIndex = 4;
}

message GetReviewsRequest {
	BedId bedId = 1;
	// Get first N results (oder is not specified) from fromIndex to fromIndex+N where N=4.
	uint32 fromIndex = 2;
}

message GetReviewsResponse {
	repeated Review reviews = 1; // 0-4 reviews. The field comment is mondadory
}